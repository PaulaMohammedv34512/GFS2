#install pacemaker
cat >> /etc/hosts << EOF
192.168.80.19 pcs1
192.168.80.20 pcs2
EOF

ssh-keygen
ssh-copy-id

yum -y install pcs fence-agents-all lvm2-cluster gfs2-utils

systemctl enable pcsd
systemctl start pcsd

echo "liyang" | passwd --stdin hacluster #on each nodes

pcs cluster auth pcs1 pcs2
pcs cluster setup --name liyang pcs1 pcs2
pcs cluster start --all
pcs cluster enable --all

pcs status cluster
pcs status corosync

# stonith change to "ignore", it does not need for 2 nodes cluster
pcs property set stonith-enabled=true
pcs property set no-quorum-policy=ignore

# disable auto failbask
pcs property set default-resource-stickiness="INFINITY"

# show settings
pcs property list

# set vip
pcs resource create Virtual_IP ocf:heartbeat:IPaddr2 ip=192.168.80.200 cidr_netmask=24 op monitor interval=30s

# show status
pcs status resources
